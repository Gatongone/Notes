# C#中的值类型和引用类型

## 值类型和引用类型的转换

* ### 引用类型 to 引用类型 的转换
    ```C#
        Object obj = new Object();
        Type type = obj as Type;//用强制转换的方法则需要try-catch保护，因为这是线程不安全的
    ```
    as操作符对于 **目标类型属于目标类型或者目标类型的派生类型** 才能转换成功，否则返回null；

    注意as操作符不能对值类型进行转换。

    </br>
* ### 引用类型 to 值类型 的转换
    ```C#
        Object obj = 1;

        if (obj is int)
        {
            int value = (int) obj;
        }

        //或者
        int value = obj is int ? (int)obj : default(int);

        //对于非空类型转换成值类型
        int v;
        int? r = 5;
        v = r is int? ?  (int)r : 0;
    ````
    is关键字会对给定类型进行检测其是否兼容(对对象检测是否是is后面类型的类或派生类，因此这是安全的),并返回一个bool类型；

    注意is的左边不能是匿名方法(lambda表达式除外)。

    </br>
* ### 值类型 to 引用类型 的转换
    ```C#
        int v = 5;
        int? r =v is int? ? (int?)v : null ;
    ```
    值到引用类型的转换一般是转换为非空类型的引用。